020000,"%DLL%"
HKLM,System\CurrentControlSet\Services\EventLog\Application\%EVENTLOG_SRC%,"TypesSupported",,0x00000007
;
; Group Policy Editor extension.
;
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"",,"Microsoft Offline Files"
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"DllName",0x00020000,%DLL%
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"EnableAsynchronousProcessing",0x00010001,0
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"NoBackgroundPolicy",0x00010001,0
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"NoGPOListChanges",0x00010001,0
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"NoMachinePolicy",0x00010001,0
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"NoSlowLink",0x00010001,0
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"NoUserPolicy",0x00010001,1
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"PerUserLocalSettings",0x00010001,0
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"ProcessGroupPolicy",0x00000000,"ProcessGroupPolicy"
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%,"RequiresSuccessfulRegistry",0x00010001,1


[RegistryDelete]
; Context menu handler
HKCR,CLSID\%CLSID_SHEX%
HKLM,%SMWCV%\%APPROVED%,%CLSID_SHEX%
; Context menu locations
HKCR,*\%SHEXCM%\%KEY%
HKCR,Drive\%SHEXCM%\%KEY%
HKCR,Directory\%SHEXCM%\%KEY%
HKCR,lnkfile\%SHEXCM%\%KEY%
HKCR,piffile\%SHEXCM%\%KEY%
HKCR,CLSID\%CLSID_MYDOCS%\%SHEXCM%\%KEY%
; Icon overlay handler
HKLM,%SMWCV%\%ICONOVERLAY%\%KEY%
; Options proppage
HKCR,CLSID\%CLSID_OfflineFilesOptions%
; Autocached files disk cleaner
HKCR,CLSID\%CLSID_TempOfflineFilesCleaner%
HKLM,%SMWCV%\%DISKCLEANER%\%KEY_TEMP%
; Pinned files disk cleaner
HKCR,CLSID\%CLSID_OfflineFilesCleaner%
HKLM,%SMWCV%\%DISKCLEANER%\%KEY%
; SyncMgr (a.k.a. OneStop) handler
HKCR,CLSID\%CLSID_SyncMgrHandler%
HKLM,%SMWCV%\%SYNCMGR%\%CLSID_SyncMgrHandler%
; NameSpace
HKCR,CLSID\%CLSID_OfflineFilesFolder%
;HKLM,%SMWCV%\Explorer\Desktop\NameSpace\%CLSID_OfflineFilesFolder%
;
; NT event log event source
;
HKLM,System\CurrentControlSet\Services\EventLog\Application\%EVENTLOG_SRC%
;
; Group Policy Editor extension.
;
HKLM,Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\%CLSID_GroupPolicyExtension%

[Strings]
; Localized strings
MENU_DESC=Offline Files Menu
OPTIONS_DESC=Offline Files Folder Options
TEMPCLEANER_DESC=Temporary Offline Files Cleaner
CLEANER_DESC=Offline Files Cleaner
SYNCMGR_DESC=Offline Files Synchronization Handler
NSE_DESC=Offline Files Folder
EVENTLOG_SRC=Offline Files
; Non-localized strings
REGDW=0x00010001
DLL=%SystemRoot%\System32\cscui.dll
CLSID_SHEX={750fdf0e-2a26-11d1-a3ea-080036587f03}
CLSID_MYDOCS={450D8FBA-AD25-11D0-98A8-0800361B1103}
CLSID_TempOfflineFilesCleaner={750fdf0f-2a26-11d1-a3ea-080036587f03}
CLSID_OfflineFilesCleaner={effc2928-37b1-11d2-a3c1-00c04fb1782a}
CLSID_SyncMgrHandler={750fdf10-2a26-11d1-a3ea-080036587f03}
CLSID_OfflineFilesFolder={AFDB1F70-2A4C-11d2-9039-00C04F8EEB3E}
CLSID_OfflineFilesOptions={10CFC467-4392-11d2-8DB4-00C04FA31A66}
CLSID_GroupPolicyExtension={C631DF4C-088F-4156-B058-4375F0853CD8}
KEY=Offline Files
KEY_TEMP=Temporary Offline Files
SMWCV=Software\Microsoft\Windows\CurrentVersion
APPROVED=Shell Extensions\Approved
SHEXCM=shellex\ContextMenuHandlers
ICONOVERLAY=Explorer\ShellIconOverlayIdentifiers
DISKCLEANER=Explorer\VolumeCaches
SYNCMGR=SyncMgr\Handlers
