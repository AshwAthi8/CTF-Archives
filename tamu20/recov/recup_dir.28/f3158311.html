<html>
<head>
<!--
Copyright (c) 2000 Microsoft Corporation
-->
<TITLE id="idTitle" name="idTitle">REMOTE_ASSISTANCE_INVITE</TITLE>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="MSThemeCompatible" content="Yes">
<LINK id="UI_StyleSheet1" REL="STYLESHEET" TYPE="text/css" HREF="../../Css/rcBuddy.css" >
<LINK id="UI_StyleSheet2" REL="stylesheet" TYPE="text/css" HREF="hcp://system/css/shared.css">
<OBJECT classid=clsid:B69003B3-C55E-4b48-836C-BC5946FC3B28 codeType=application/x-oleobject id=MsgrObj width=1 height=1></OBJECT>
<SCRIPT>
var g_bSignIn = false;
var g_timeLastMessengerEventOccurred = 0;
var g_bSetMessengerEventCallback = false;
</SCRIPT>
<SCRIPT FOR="MsgrObj" EVENT="OnSignin" LANGUAGE="JavaScript">
if (arguments[0] == 0)
g_bSignIn = true;
</SCRIPT>
<SCRIPT FOR="MsgrObj" EVENT="OnMyStatusChange" LANGUAGE="JavaScript">
;
var state;
try
{
state=MsgrObj.MyStatus;
if(state == 0x0100 || state == 0x0200 || state == 0x0300 )
{
value=0x0200;
idDivMSNConnected.className="MaxWidth height14 DisplayNone";
idDivMSNSetup.className="MaxWidth valignmiddle height14 DisplayNone";
idDivMSNSignIn.className="MaxWidth valigntop height14 DisplayNone";
idDivMSNSigning.className="MaxWidth height14 Display valigntop";
idEmailInput.focus();
}
else if (state&0x0002 && value==0x0200)
{
value=0;
idDivMSNConnected.className="MaxWidth height14 Display";
idDivMSNSetup.className="MaxWidth valignmiddle height14 DisplayNone";
idDivMSNSignIn.className="MaxWidth valigntop height14 DisplayNone";
idDivMSNSigning.className="MaxWidth height14 DisplayNone valigntop";
getContactList();
idLink1Container.innerHTML="<img class='valignbottom borderNone' src='../common/dis_arrow.bmp'></img>&nbsp;&nbsp;<Span id='idLink1' name='idLink1' class='sys-font-body' disabled>"+ L_Invite_Text + "</span>";
idEmailInput.focus();
}
else if (state==0x0400)
{
g_bSignIn = false;
value=0;
idDivMSNConnected.className="MaxWidth height14 DisplayNone";
idDivMSNSetup.className="MaxWidth valignmiddle height14 DisplayNone";
idDivMSNSignIn.className="MaxWidth valigntop height14 Display";
idDivMSNSigning.className="MaxWidth height14 DisplayNone valigntop";
if (idDivMSNSetup.className=="MaxWidth valignmiddle height14 Display")
{
idLink3.focus();
}
if (idDivMSNSetupPro.className=="MaxWidth valignmiddle height14 Display")
{
idLink6.focus();
}
if (idDivMSNSignIn.className=="MaxWidth valigntop height14 Display")
{
idbtnMSNSignIn.focus();
}
}
else if(state==0x0001 && value==0x0200)
{
value=0;
idDivMSNConnected.className="MaxWidth height14 DisplayNone";
idDivMSNSetup.className="MaxWidth valignmiddle height14 DisplayNone";
idDivMSNSignIn.className="MaxWidth valigntop height14 Display";
idDivMSNSigning.className="MaxWidth height14 DisplayNone valigntop";
if (idDivMSNSetup.className=="MaxWidth valignmiddle height14 Display")
{
idLink3.focus();
}
if (idDivMSNSetupPro.className=="MaxWidth valignmiddle height14 Display")
{
idLink6.focus();
}
if (idDivMSNSignIn.className=="MaxWidth valigntop height14 Display")
{
idbtnMSNSignIn.focus();
}
}
else
{
if (0 == arguments[0])
{
getContactList();
idLink1Container.innerHTML="<img class='valignbottom borderNone' src='../common/dis_arrow.bmp'></img>&nbsp;&nbsp;<Span id='idLink1' name='idLink1' class='sys-font-body' disabled>"+L_Invite_Text+"</span>";
}
}
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
</SCRIPT>
<SCRIPT FOR="MsgrObj" EVENT="OnContactStatusChange" LANGUAGE="JavaScript">
;
if (g_bSignIn)
{
HandleMessengerEvent();
}
</SCRIPT>
<SCRIPT FOR="MsgrObj" EVENT="OnContactListRemove" LANGUAGE="JavaScript">
;
if (0 == arguments[0] && g_bSignIn)
{
HandleMessengerEvent();
}
</SCRIPT>
<SCRIPT FOR="MsgrObj" EVENT="OnContactListAdd" LANGUAGE="JavaScript">
;
if (0 == arguments[0] && g_bSignIn)
{
HandleMessengerEvent();
}
</SCRIPT>
<Script Language="VBScript">
Function VBMessageBox(sPrompt, iBtn, sTitle)
MsgBox sPrompt, iBtn, sTitle
End Function
</Script>
<Script id="idScript1" name="idScript1" language="javascript">
var L_NOTO_Text = "Please provide a friendly name.";
var L_ERRACCESSDENIED_Text = "Directly launching this page is not allowed. ";
var L_MSOUTLOOK_Text ="Microsoft Outlook";
var L_OUTLOOKEXPRESS_Text ="Outlook Express";
var L_OUTLOOK_Text ="Outlook";
var L_MICROSOFT_Text ="Microsoft";
var L_EXPRESS_Text ="Express";
var L_UNKNOWN_Text ="(Unknown)";
var L_BUSY_Text ="(Busy)";
var L_ONTHEPHONE_Text ="(On The Phone)";
var L_BERIGHTBACK_Text ="(Be Right Back)";
var L_AWAY_Text ="(Away)";
var L_OUTTOLUNCH_Text ="(Out To Lunch)";
var L_LOGON_Text ="Logging On...";
var L_LOGOFF_Text ="Logging Off...";
var L_SignInFailed_Text = "Sign in failed: ";
var L_Invite_Text = "Invite this person";
var L_None_Text = "None";
var L_CONTINUE_Text ="Continue";
var value;
var oSmapi;
var flag=0;
var g_wshShell = null;
function isAMD64Pro()
{
if(parent.parent.pchealth.UserSettings.MachineSKU.SKU.match( /_64/ ) &&
parent.parent.pchealth.UserSettings.MachineSKU.SKU.match( "Professional" ))
{
return true;
}
else
{
return false;
}
}
function ShowEscalationHelp(is64)
{
var fileToShow = "";
if (is64)
{
fileToShow = "escalationhelp-pro.htm";
}
else
{
fileToShow = "escalationhelp.htm";
}
var oShell = new ActiveXObject("WScript.Shell");
var oFSO = new ActiveXObject("Scripting.FileSystemObject");
var vArgs = new Array(2);
vArgs[0] = oShell;
vArgs[1] = oFSO;
ret=window.showModalDialog(fileToShow,vArgs,"DialogWidth:500px;DialogHeight:150px;Status:no;scroll:no;help:no");
}
function NotifyOnShieldsUp()
{
var PortNumber = 3389;
var SessMgrAppName = "\\system32\\sessmgr.exe";
var result1, result2;
if(isAMD64Pro())
{
try
{
result1 = CanOpenPort(SessMgrAppName,0);
result2 = CanOpenPort("", 3389);
if (!(result1 || result2))
{
ShowEscalationHelp(true);
}
}
catch(e)
{
}
return;
}
try
{
result2 = CanOpenPort("", 3389);
if (!result2)
{
ShowEscalationHelp(false);
}
}
catch(e)
{
}
}
function HandleMessengerEvent()
{
;
try
{
var timeObj;
timeObj = new Date();
g_timeLastMessengerEventOccurred = timeObj.getTime();
;
if (!g_bSetMessengerEventCallback)
{
;
g_bSetMessengerEventCallback = true;
setTimeout( "MessengerEventCallback()", 1000);
}
timeObj = null;
}
catch (e)
{
alert("Error :"+e.description);
}
;
}
function MessengerEventCallback()
{
;
var timeObj;
var timemsNow = 0;
timeObj = new Date();
timemsNow = timeObj.getTime();
;
if (timemsNow - g_timeLastMessengerEventOccurred < 200)
{
;
setTimeout( "MessengerEventCallback()", 1000);
}
else
{
;
getContactList();
idLink1Container.innerHTML="<img class='valignbottom borderNone' src='../common/dis_arrow.bmp'></img>&nbsp;&nbsp;<Span id='idLink1' name='idLink1' class='sys-font-body' disabled>"+L_Invite_Text+"</span>";
g_bSetMessengerEventCallback = false;
}
timeObj = null;
;
}
function onLoadHelper()
{
;
try
{
if ( "object" != typeof( parent.idframeset ) )
{
setTimeout( "onLoad()", 5000 );
}
else
{
onLoad();
}
}
catch (e)
{
alert(parent.parent.L_RCCTL_Text);
}
;
}
function onLoad()
{
;
var fMsgrDisable = false;
var fMsgrPro = false;
try
{
parent.idframeset.rows = "0%;*";
if( null == parent.parent.OnLoad || parent.parent.g_bRAStart == null)
{
idBody.style.visibility = "hidden";
parent.window.navigate( "hcp://CN=Microsoft%20Corporation,L=Redmond,S=Washington,C=US/Remote%20Assistance/Escalation/Common/rcscreen1.htm" );
return;
}
if(parent.parent.pchealth.UserSettings.MachineSKU.SKU.match( /64/ ))
{
if(parent.parent.pchealth.UserSettings.MachineSKU.SKU.match( "Professional" ))
{
fMsgrPro = true;
}
else
{
fMsgrDisable = true;
}
}
else
{
}
if(fMsgrDisable)
{
idDivNoMSNSKU.className="MaxWidth height14 Display";
NotifyOnShieldsUp();
return;
}
var wshShell = new ActiveXObject("WScript.Shell");
var iNoMessenger = 0;
try {
iNoMessenger = wshShell.RegRead("HKLM\\Software\\policies\\Microsoft\\Messenger\\Client\\PreventRun");
}
catch (e)
{
}
if (iNoMessenger == 0)
{
try {
iNoMessenger = wshShell.RegRead("HKCU\\Software\\policies\\Microsoft\\Messenger\\Client\\PreventRun");
}
catch (e)
{
}
}
if (iNoMessenger == 1)
{
idDivNoMSN.className="MaxWidth height14 Display";
}
else
{
var MSNState;
MSNState = MsgrObj.MyStatus;
switch(MSNState)
{
case 0x0001:
case 0x0400:
idDivMSNConnected.className="MaxWidth height14 DisplayNone";
idDivMSNSetup.className="MaxWidth valignmiddle height14 DisplayNone";
idDivMSNSignIn.className="MaxWidth valigntop height14 Display";
idDivMSNSigning.className="MaxWidth height14 DisplayNone valigntop";
idbtnMSNSignIn.focus();
break;
case 0x0100:
case 0x0200:
case 0x0300:
idDivMSNConnected.className="MaxWidth height14 DisplayNone";
idDivMSNSetup.className="MaxWidth valignmiddle height14 DisplayNone";
idDivMSNSignIn.className="MaxWidth valigntop height14 DisplayNone";
idDivMSNSigning.className="MaxWidth height14 Display valigntop";
break;
case 0x0006:
case 0x000A:
case 0x000E:
case 0x0012:
case 0x0022:
case 0x0032:
case 0x0042:
case 0x0002:
g_bSignIn = true;
idDivMSNConnected.className="MaxWidth height14 Display";
idDivMSNSetup.className="MaxWidth valignmiddle height14 DisplayNone";
idDivMSNSignIn.className="MaxWidth valigntop height14 DisplayNone";
idDivMSNSigning.className="MaxWidth height14 DisplayNone valigntop";
getContactList();
break;
case 0x0000:
default:
idDivMSNConnected.className="MaxWidth height14 DisplayNone";
if(fMsgrPro == true)
{
idDivMSNSetupPro.className="MaxWidth valignmiddle height14 Display";
idDivMSNSignIn.className="MaxWidth valigntop height14 DisplayNone";
idDivMSNSigning.className="MaxWidth height14 DisplayNone valigntop";
idLink6.focus();
break;
}
else
{
idDivMSNSetup.className="MaxWidth valignmiddle height14 Display";
idDivMSNSignIn.className="MaxWidth valigntop height14 DisplayNone";
idDivMSNSigning.className="MaxWidth height14 DisplayNone valigntop";
idLink3.focus();
break;
}
}
}
}
catch(error)
{
idDivMSNConnected.className="MaxWidth height14 DisplayNone";
idDivMSNSetup.className="MaxWidth valignmiddle height14 Display";
idDivMSNSignIn.className="MaxWidth valigntop height14 DisplayNone";
idDivMSNSigning.className="MaxWidth height14 DisplayNone valigntop";
idLink3.focus();
return;
}
NotifyOnShieldsUp();
;
}
function getContactList()
{
;
var txtOnline = "";
var txtOnline1 = "";
var txtOnline2 = "";
var txtOnline3 = "";
var txtOnline4 = "";
var txtOnline5 = "";
var txtOnline6 = "";
var txtOnline7 = "";
var txtOnline8 = "";
var txtOffline = "";
var nUser = 0;
var User="";
var list="";
try
{
list = MsgrObj.MyContacts;
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
try
{
for (nUser=0; nUser<list.Count; nUser++)
{
User=list.Item(nUser);
switch(User.Status)
{
case 0:
case 0x0001:
case 0x0100:
case 512:
case 768:
case 1024:
txtOffline =getUserWithState(User)+txtOffline;
break;
case 0x0002:
txtOnline1 =getUserWithState(User)+txtOnline1;
break;
case 0x000A:
txtOnline2 =getUserWithState(User)+txtOnline2;
break;
case 0x000E:
txtOnline3 =getUserWithState(User)+txtOnline3;
break;
case 0x0012:
txtOnline4 =getUserWithState(User)+txtOnline4;
break;
case 0x0022:
txtOnline5 =getUserWithState(User)+txtOnline5;
break;
case 0x0032:
txtOnline6 =getUserWithState(User)+txtOnline6;
break;
case 0x0042:
txtOnline7 =getUserWithState(User)+txtOnline7;
break;
case 0x0006:
txtOnline8 =getUserWithState(User)+txtOnline8;
break;
}
txtOnline=txtOnline1+txtOnline2+txtOnline5+txtOnline7+txtOnline6+txtOnline3+txtOnline4+txtOnline8;
}
if (txtOnline.length == 0)
{
txtOnline = "<BR><Span class='MaxWidth' id='idNoneOnline' name='idNoneOnline'><IMG alt='' src='../common/buddy_none.gif'>&nbsp;"+L_None_Text+"</span>";
}
if (txtOffline.length == 0)
{
txtOffline = "<BR><Span class='MaxWidth' id='idNoneOffline' name='idNoneOffline'><IMG alt='' src='../common/buddy_none.gif'>&nbsp;"+L_None_Text+"</span>";
}
document.all.mContactsOnline.innerHTML = txtOnline;
document.all.mContactsOffline.innerHTML = txtOffline;
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
;
}
function getUserWithState(pUser)
{
;
var ret;
var state;
try
{
state=pUser.Status;
switch (state)
{
case 0:
statusImg ="<IMG alt='' src='../common/buddy_Offline.gif'>";
statusText =L_UNKNOWN_Text;
break;
case 0x0002:
statusImg = "<IMG alt='' src='../common/buddy.gif'>";
statusText="";
break;
case 0x0001:
case 0x0006:
statusImg ="<IMG alt='' src='../common/buddy_Offline.gif'>";
statusText="";
break;
case 0x000A:
statusImg="<IMG alt='' src='../common/buddy_busy.gif'>";
statusText=L_BUSY_Text;
break;
case 0x0032:
statusImg = "<IMG alt='' src='../common/buddy_busy.gif'>";
statusText=L_ONTHEPHONE_Text;
break;
case 0x000E:
statusImg = "<IMG alt='' src='../common/buddy_away.gif'>";
statusText=L_BERIGHTBACK_Text;
break;
case 0x0012:
case 0x0022:
statusImg ="<IMG alt='' src='../common/buddy_away.gif'>";
statusText=L_AWAY_Text;
break;
case 0x0042:
statusImg = "<IMG alt='' src='../common/buddy_away.gif'>";
statusText=L_OUTTOLUNCH_Text;
break;
case 0x0100:
case 512:
case 768:
ret = L_LOGON_Text;
break;
case 1024:
ret = L_LOGOFF_Text;
break;
}
var sName = EscapeName(pUser.FriendlyName);
var sSigninName = pUser.SigninName;
if (state==0x0001 || state==0x0006)
{
ret="<BR><Span class='MaxWidth' name='idOfflineItem' id='idOfflineItem' onclick='EnableMSNInvite(\"" + sSigninName +"\");' ondblclick='EnableMSNInvite(\"" + sSigninName + "\");DoInvite(\"" + sSigninName +"\");'>&nbsp;"+statusImg+" "+ sName +statusText+"</span>";
}
else
{
ret="<BR><Span class='MaxWidth' name='idOnlineItem' id='idOnlineItem' onclick='EnableMSNInvite(\"" + sSigninName +"\");' ondblclick='EnableMSNInvite(\"" + sSigninName + "\");DoInvite(\"" + sSigninName +"\");'>&nbsp;"+statusImg+" "+sName+statusText+"</span>";
}
return ret;
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
;
}
function document.onclick()
{
;
try
{
if (event.srcElement.id!="idLink1")
{
var e=new Enumerator(mContactsOffline.all.tags("span"));
for (;!e.atEnd();e.moveNext())
{
x = e.item();
x.className="MaxWidth";
}
var e=new Enumerator(mContactsOnline.all.tags("span"));
for (;!e.atEnd();e.moveNext())
{
x = e.item();
x.className="MaxWidth";
}
idLink1Container.innerHTML="<img class='valignbottom borderNone' src='../common/dis_arrow.bmp'></img>&nbsp;&nbsp;<Span id='idLink1' name='idLink1' class='sys-font-body' disabled>" + L_Invite_Text + "</span>";
}
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
;
}
function EnableMSNInvite(sName)
{
;
try
{
var e=new Enumerator(mContactsOffline.all.tags("span"));
for (;!e.atEnd();e.moveNext())
{
x = e.item();
x.className="MaxWidth";
}
var e=new Enumerator(mContactsOnline.all.tags("span"));
for (;!e.atEnd();e.moveNext())
{
x = e.item();
x.className="MaxWidth";
}
if (event.srcElement.tagName=="IMG")
{
event.srcElement.parentElement.className="MaxWidth sys-table-cell-bgcolor3";
}
else
{
event.srcElement.className="MaxWidth sys-table-cell-bgcolor3";
}
idLink1Container.innerHTML="<Img id='idimgLink1' name='idimgLink1' onclick='DoInvite(\"" + sName + "\");return false;' class='valignbottom borderNone' ondragstart='return false;' src='../common/green_rest_16x.bmp' onmouseover='this.style.cursor=\"hand\";document.getElementById(\"idLink1\").style.textDecorationUnderline=true' onmouseout='document.getElementById(\"idLink1\").style.textDecorationUnderline=false'></Img>&nbsp;&nbsp;<A href='' id='idLink1' name='idLink1' ondragstart='return false;' tabindex='1' class='valignmiddle sys-font-body sys-link-normal' onclick='DoInvite(\"" + sName + "\");return false;'>" +L_Invite_Text+"</A>";
event.cancelBubble=true;
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
;
}
function EnableEmailInvite()
{
;
try
{
if(idEmailInput.value.length == 0)
{
if (window.event.keyCode == 13)
{
alert(L_NOTO_Text);
idEmailInput.focus();
window.event.returnValue=false;
}
else
{
idLink2Container.innerHTML = "<img class='valignbottom borderNone' src='../common/dis_arrow.bmp'></img>&nbsp;&nbsp;<Span id='idLink2' name='idLink2' class='sys-font-body' disabled>" + L_CONTINUE_Text + "</span>";
}
}
else
{
if (window.event.keyCode == 13)
{
GotoEmail();
window.event.returnValue=false;
}
else
{
idLink2Container.innerHTML ="<Img id='idimgLink2' name='idimgLink2' onclick='GotoEmail();return false;' class='valignbottom borderNone' ondragstart='return false;' src='../common/green_rest_16x.bmp' onmouseover='idimgLink2.style.cursor=\"hand\";document.getElementById(\"idLink2\").style.textDecorationUnderline=true;' onmouseout='document.getElementById(\"idLink2\").style.textDecorationUnderline=false;'></Img>&nbsp;&nbsp;<A href='' id='idLink2' name='idLink2' ondragstart='return false;' tabindex='4' class='valignmiddle sys-font-body sys-link-normal' onclick='GotoEmail();return false;'>" +L_CONTINUE_Text+"</A>";
}
}
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
;
}
function GotoEmail()
{
;
try
{
parent.parent.sTo = idEmailInput.value;
parent.navigate("rcScreen5.htm");
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
;
}
function SignIn()
{
;
try {
var oMsgrUI = new ActiveXObject("Messenger.MessengerApp");
oMsgrUI.LaunchLogonUI();
}
catch(error)
{
alert(L_SignInFailed_Text + error.description);
return;
}
;
}
function DoInvite(sName)
{
;
var list, nUser;
try
{
list = MsgrObj.MyContacts;
for (nUser=0; nUser<list.Count; nUser++)
{
User=list.Item(nUser);
if (User.SigninName==sName)
{
if (User.Status==0x0012 || User.Status==0x0022)
{
var L_CONFIRMAWAYUSER_Text=" is away from the computer, do you still want to send the invitation?";
if (confirm(User.FriendlyName + L_CONFIRMAWAYUSER_Text))
{
var EffectiveStatus = User.Status & 0x0002;
if(EffectiveStatus != 0x0002)
{
var L_SessionStatusAppShutDown_Text = "The Windows Messenger server has stopped responding. Please try to connect again.";
var L_RA_Text = "Remote Assistance";
VBMessageBox(L_SessionStatusAppShutDown_Text, 48, L_RA_Text);
return;
}
}
else
return;
}
else if (User.Status==0x0001||User.Status==0x0006)
{
var L_ConfirmOfflineUser_Text =" is offline. Do you want to send an e-mail invitation?";
if (confirm(User.FriendlyName + L_ConfirmOfflineUser_Text))
{
parent.parent.sTo = User.FriendlyName;
parent.navigate("rcScreen5.htm");
}
return;
}
else
{
}
break;
}
}
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
if (nUser >= list.Count)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
try {
var vArgs = new Array(2);
oSession = new ActiveXObject("rcbdyctl.IMSession");
oSession.HSC_Invite(User);
oSession = null;
}
catch (e)
{
var L_IMSessionFailed_Text = "Send Invitation failed: ";
alert(L_IMSessionFailed_Text + e.description);
}
;
}
function EscapeName( szName )
{
;
try
{
var szTmp = new String( szName );
var re = /\'/g;
var szEscapedName = szTmp.replace( re, "&prime;" );
re = /\"/g;
szEscapedName = szEscapedName.replace( re, "&Prime;" );
szEscapedName = parent.parent.EscapedName( szName );
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
;
return szEscapedName;
}
</Script>
<script language="vbscript">
'Have to use VBScript to access the firewall API, it uses
'passed in variants for output, jscript doesn't support by ref
'on basic types.
function CanOpenPort(AppName, PortNumber)
dim ShellObj
Set ShellObj = CreateObject("WScript.Shell")
AppName = ShellObj.ExpandEnvironmentStrings("%windir%") & AppName
dim FirewallManager
Set FirewallManager = CreateObject("HNetCfg.FwMgr")
dim NET_FW_IP_VERSION_ANY
NET_FW_IP_VERSION_ANY = 2
dim NET_FW_IP_PROTOCOL_TCP
NET_FW_IP_PROTOCOL_TCP = 6
dim IPAddress
dim AppAllowed, PortRestricted
AppAllowed = false
PortRestricted = false
FirewallManager.IsPortAllowed AppName, NET_FW_IP_VERSION_ANY, PortNumber, IPAddress, NET_FW_IP_PROTOCOL_TCP, AppAllowed, PortRestricted
if AppAllowed = True and PortRestricted = False then CanOpenPort = true else CanOpenPort = false
End Function
</script>
<Style>
.Height2
{
height:20px;
}
.height14
{
height:150px;
}
.Width