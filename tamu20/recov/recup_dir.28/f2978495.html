var L_SAYS_Text = " says: ";
var L_INITIALHELPERCHAT1_Text = "----------<BR>Welcome to Remote Assistance.<BR>To explore your options, click Help.<P>";
var L_INITIALHELPERCHAT2_Text = " is connected to <BR>";
var L_RCCTL_Text = "Remote Assistance failed. Please try again. ";
var L_NOIP_Text = "There is no Internet connection. To use Remote Assistance, please connect to the Internet. ";
var g_bVoIPEnabled = true;
var g_szLocalUser = null;
var g_oShell = null;
var g_oEnv = null;
function DisplayMessage( szMsg )
{
;
try
{
var vArgs = new Array(1);
vArgs[0] = szMsg;
var vRetVal = window.showModelessDialog( "hcp://system/Remote Assistance/Interaction/Common/ErrorMsgs.htm", vArgs, "dialogwidth:405px;dialogHeight:165px;status:no;resizable:no;help:no" );
}
catch(error)
{
FatalError( error.description, error );
}
;
}
function SoundBeep()
{
;
;
return g_szLocalUser;
}
function GetLocalUser()
{
;
try
{
if( null == g_oShell) { g_oShell = new ActiveXObject("WScript.Shell"); }
if(null == g_oEnv) { g_oEnv = g_oShell.Environment("process"); }
var szTmp = g_oEnv("USERNAME");
if( szTmp.length < 20 )
{
g_szLocalUser = szTmp;
}
else
{
g_szLocalUser = szTmp.slice(0, 20) + "...";
}
g_szLocalUser = EscapedName( g_szLocalUser );
}
catch(error)
{
FatalError( error.description );
}
;
return g_szLocalUser;
}
function GetLocalIPAddr()
{
var oSetting = null;
var ip = null;
try
{
oSetting = new ActiveXObject( "rcbdyctl.Setting" );
ip = oSetting.GetIPAddress;
if (ip.length == 0) {
alert(L_NOIP_Text);
return ip;
}
oSetting = null;
}
catch(e)
{
FatalError(L_RCCTL_Text, e);
return ip;
}
return ip;
}
function ChangeHCToKioskMode(left, top, width, height)
{
;
try
{
;
idCtx.ChangeContext( "kioskmode", "");
idCtx.setWindowDimensions( left, top, width, height);
}
catch(error)
{
FatalError( L_RCCTL_Text, error );
}
;
}
function GetWinDir()
{
;
var szWinDir = null;
try
{
if( null == g_oShell) { g_oShell = new ActiveXObject("WScript.Shell"); }
if(null == g_oEnv) { g_oEnv = g_oShell.Environment("process"); }
szWinDir = g_oEnv("SystemRoot");
}
catch(error)
{
FatalError(error.description, error);
}
;
return szWinDir;
}
function LaunchHelp( nTopicId )
{
;
try
{
var szURL = 'hcp://CN=Microsoft%20Corporation,L=Redmond,S=Washington,C=US/Remote%20Assistance/Common/RAHelp.htm?' + nTopicId;
var szWinDir = GetWinDir();
window.showModelessDialog( szURL, szWinDir, "dialogHeight:400px;dialogWidth:550px;status:no;resizable:yes;help:no" );
}
catch(error)
{
FatalError(error.description, error);
}
;
return;
}
function LaunchHelpEx( nTopicId )
{
;
try
{
var szURL = 'hcp://system/Remote%20Assistance/Common/RAHelp.htm?' + nTopicId;
var szWinDir = GetWinDir();
window.showModelessDialog( szURL, szWinDir, "dialogHeight:440px;dialogWidth:385px;status:no;resizable:no;help:no" );
}
catch(error)
{
FatalError(error.description, error);
}
;
return;
}
function FatalError( szMessage, error, bClose)
{
try
{
var szMsg = null;
if( (szMessage == null) || (szMessage.length < 5))
{
szMessage = L_RCCTL_Text;
}
var vArgs = new Array(1);
vArgs[0] = szMessage;
;
var vRetVal = window.showModalDialog( "hcp://system/Remote Assistance/Interaction/Common/ErrorMsgs.htm" + '?' + szMessage, vArgs, "dialogwidth:405px;dialogHeight:165px;status:no;resizable:no;help:no" );
AddOpenSubWin( vRetVal );
}
catch(x)
{
}
}
var openWins = new Array(10);
var openWinCnt = 0;
function AddOpenSubWin( win )
{
try
{
openWins[openWinCnt%10] = win;
openWinCnt++;
}
catch(error)
{
}
}
function CloseOpenSubWin()
{
var i = 0;
for ( i=0; i< 10; i++)
{
if(null != openWins[i])
{
try
{
if(openWins[i].closed == false)
{
openWins[i].close();
}
}
catch(error)
{
}
}
}
}
function FormatChatMsg( szMsg )
{
var szNewText = '<BR><font id="MsgTxt" name="MsgTxt" class="sys-font-body sys-color-body-helper">' + szMsg + '</font><P>';
return szNewText;
}
function CreateChatGreeting( szLocalUser, szRemoteUser )
{
szLocalUser = EscapedName( szLocalUser );
szRemoteUser = EscapedName( szRemoteUser );
var szNewText = FormatChatMsg( L_INITIALHELPERCHAT1_Text + "<P>" + szLocalUser + L_INITIALHELPERCHAT2_Text + szRemoteUser + ".<P>" + L_INITIALHELPERCHAT3_Text );
return szNewText;
}
function FormatSendChatText( szUser, szChatText )
{
var szNewText = '<BR><font id="MsgTxt" name="MsgTxt" class="styChatColorBlue styText">' + szUser + L_SAYS_Text + '</font><BR>&nbsp;&nbsp;&nbsp;&nbsp;<font class="styText styBlack">' + szChatText + '</font>';
return szNewText;
}
var iKeyCode = new Array(3);
var iKeyCnt = 0;
function IsAlpha( keyCode )
{
var fRetVal = false;
alert("keyCode: " + keyCode);
if( ( 64 < keyCode) && ( keyCode < 91) )
{
fRetVal = true;
}
return fRetVal;
}
var L_DOTS_Text = "...";
function EscapedName( szName )
{
;
try
{
var szTmp = new String( szName );
var re = /&/g;
var szEscapedName = szTmp.replace( re, "&amp;" );
var re = /</g;
szEscapedName = szEscapedName.replace( re, "&lt;" );
re = />/g;
szEscapedName = szEscapedName.replace( re, "&gt;" );
}
catch(error)
{
alert(parent.parent.L_RCCTL_Text);
return;
}
;
return szEscapedName;
}
