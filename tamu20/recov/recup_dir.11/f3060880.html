<HTML XMLNS:helpcenter>
<HEAD>
<!--
Copyright (c) 2000 Microsoft Corporation
-->
<helpcenter:context id=idCtx />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="MSThemeCompatible" content="Yes">
<TITLE>Remote Assistance</TITLE>
<LINK id="UI_StyleSheet" REL="stylesheet" TYPE="text/css" HREF="../../Css/rc.css">
<script id="Script1" name="Script1" LANGUAGE="Javascript" SRC="../../Common/Constants.js"> </script>
<script id="Script2" name="Script2" LANGUAGE="Javascript" SRC="../../Common/common.js"> </script>
<script id="Script3" name="Script3" LANGUAGE="Javascript" SRC="RAServer.js"> </script>
<!-- The SAF class factory object -->
<OBJECT classid=CLSID:FC7D9E02-3F9E-11d3-93C0-00C04F72DAF7 height=0 id="oSAFClassFactory" name="oSAFClassFactory"
width=0></OBJECT>
</HEAD>
<frameset framespacing=0 id="idFrameSet0" name="idFrameSet0" cols="*,2px,165px" frameborder=0>
<frame id="idFrameChatTop" name="idFrameChatTop" noresize src="RAChatServer.htm">
<frame id="idFrameblank1" name="idFrameblank1" noresize src="DividerBar1.htm">
<frame id="idFrameTools" name="idFrameTools" noresize src="RAServerToolBar.htm">
</frameset>
<SCRIPT Language="JScript">
var L_ERRSWITCHDESKTOPMODE_Text = "Failed to grant remote control.";
var L_ERRRCPERMDENIED_Text = "Remote control of this computer is not allowed.";
var L_TAKECONTROL1_Text = "\n\n----------\n";
var L_TAKECONTROL2_Text = " has taken control of ";
var L_TAKECONTROL3_Text = "'s computer.\n To stop control, press ESC key.\nNote that using any key sequence or combination including the ESC key such as (ESC+TAB) will also stop control\n----------";
var L_64DISABLED_Text = "The person you are using Remote Assistance with has tried to start a voice connection with you. Remote Assistance does not support voice connections in the version of Windows you are using.";
var L_ERRVOIP1_Text = "A voice connection could not be established. Please try again later.";;
var L_ERRVOIP2_Text = "The necessary hardware and/or configuration to use a voice connection is not available;'Start Talking' will be disabled for the remainder of this Remote Assistance session.";
var vArgs = null;
var g_numTries = 0;
var g_bChatBoxHidden = false;
var g_bNewBinaries = false;
var g_bUserDisconnect = false;
var g_bChatMode = true;
var g_bConnected = false;
var g_bRC = false;
var g_bNewLine = false;
var g_szLocalUser = null;
var g_bVoipConnected = false;
var g_bVoipOn = false;
var g_bStartEnabled = true;
var g_szVoipIPList = null;
var g_szVoipKey = null;
var g_stateVoipMe = 0;
var g_stateVoipYou = 0;
var g_VoipBandwidth = 0;
g_bDebug = false;
var g_StartTalking = 1;
function document.onkeydown()
{
;
try
{
if (window.event.keyCode==8)
{
window.event.returnValue=false;
}
}
catch(error)
{
;
}
;
}
function ShowVoiceHelp()
{
var oShell = new ActiveXObject("WScript.Shell");
var oFSO = new ActiveXObject("Scripting.FileSystemObject");
var vArgs = new Array(2);
vArgs[0] = oShell;
vArgs[1] = oFSO;
ret=window.showModalDialog("..\\common\\VoiceFirewallmsg.htm",vArgs,"DialogWidth:405px;DialogHeight:168px;Status:no;scroll:no");
}
function PostInit()
{
;
try
{
GetLocalUser();
InitVoIP();
}
catch(error)
{
FatalError( L_RCCTL_Text, error );
}
;
}
function ResizeUI()
{
try
{
idCtx.setWindowDimensions( idCtx.x, idCtx.y, "384", "528");
}
catch(error)
{
}
}
function InitiateRCSession()
{
try
{
g_bConnected = true;
;
;
frames.idFrameTools.InitRAServerToolBar();
if( (idCtx.width != "384" ) || ( idCtx.height != "528" ))
{
ResizeUI();
}
g_Helpee_oSAFRemoteDesktopSession = parent.oRCSession;
if( parent.gFrom.length > 0 )
{
g_szLocalUser = parent.gFrom;
}
else
{
oDeskMgr = parent.pchealth.CreateObject_RemoteDesktopManager();
userHelpBlob = oDeskMgr.userHelpBlob;
obj = new ActiveXObject( "SAFRCFileDlg.RASetting" );
var sIsIM = obj.GetPropertyInBlob(userHelpBlob, "IM");
if(sIsIM == "1")
{
var oMsgr = new ActiveXObject("Messenger.UIAutomation");
g_szLocalUser = oMsgr.MyFriendlyName;
parent.gFrom = g_szLocalUser;
}
else
{
g_szLocalUser = GetLocalUser();
}
}
;
;
}
catch(error)
{
FatalError( L_RCCTL_Text, error );
return;
}
Init_Helpee_SALEM();
try
{
setTimeout('PostInit()', 1000);
}
catch(error)
{
FatalError( L_ERRFATAL_Text, error );
}
;
return;
}
function DoLoad()
{
var L_ERRACCESSDENIED_Text = "Directly launching this page is not allowed. ";
if(null==parent.OnLoad1)
{
idBody.style.visibility = "hidden";
alert( L_ERRACCESSDENIED_Text );
return;
}
}
function Helpee_ControlChannelDataReadyEventHandler()
{
;
var ControlData = null;
try
{
ControlData = g_Helpee_oControlChannel.ReceiveChannelData();
}
catch(error)
{
FatalError( L_RCCTL_Text, error );
}
Helpee_ParseControlData ( ControlData );
;
return;
}
var g_oDeskMgr = null;
var nRAType = 0;
function Helpee_ParseControlData ( ControlData )
{
;
var Doc = new ActiveXObject("microsoft.XMLDOM");
var RCCommand = null;
var szCommandName = null;
var L_ERRTAKECONTROL3_Text = "Your screen resolution has been changed, which caused ";
var L_ERRTAKECONTROL4_Text = " to lose keyboard and mouse control of your computer. ";
var L_ERRTAKECONTROL5_Text = " can request control of your computer again and resume the session. ";
try
{
if ( true == parent.gIsURA )
{
nRAType = 1;
}
else
{
nRAType = 0;
}
;
idCtx.minimized = false;
idCtx.bringToForeground();
;
if( false == Doc.loadXML( ControlData ))
{
FatalError ( Doc.parseError.reason );
}
RCCommand = Doc.documentElement;
szCommandName = RCCommand.getAttribute( "NAME" );
;
if( szCommandName == "FILEXFER" )
{
;
SoundBeep();
var vArgs = new Array(13);
vArgs[0] = 1;
vArgs[1] = g_Helpee_oControlChannel;
vArgs[2] = g_Helpee_oSAFRemoteDesktopChannelMgr;
vArgs[3] = RCCommand.getAttribute( "FILENAME" );
vArgs[4] = RCCommand.getAttribute( "FILESIZE" );
vArgs[5] = RCCommand.getAttribute( "CHANNELID" );
vArgs[6] = new ActiveXObject("Scripting.FileSystemObject");
vArgs[7] = new ActiveXObject("SAFRCFileDlg.FileSave");
vArgs[8] = oSAFClassFactory;
vArgs[9] = parent.gHelper;
vArgs[10] = new ActiveXObject("RACplDlg.RAEventLog");
vArgs[11] = parent.gHelperIP;
vArgs[12] = g_szLocalUser;
;
var subWin = window.showModelessDialog( "hcp://system/Remote Assistance/Interaction/Common/RCFileXfer.htm", vArgs, "dialogwidth:" + "405" + "px;dialogHeight:" + "179" + "px;status:no;resizable:no;help:no");
AddOpenSubWin( subWin );
}
else if ( szCommandName == "EXPERTIP" )
{
parent.gHelperIP = RCCommand.getAttribute( "EXPERTIPDATA" );
}
else if ( szCommandName == "REMOTECTRLSTART" )
{
;
SoundBeep();
;
var oRARegSetting = new ActiveXObject("RACplDlg.RARegSetting");
var bAllowFullControl = 0;
if( false == parent.gIsURA )
{
bAllowFullControl = oRARegSetting.AllowFullControl;
}
else
{
bAllowFullControl = oRARegSetting.AllowUnSolicitedFullControl;
}
;
if( 1 == bAllowFullControl )
{
;
var vArgs = new Array(1);
vArgs[0] = parent.gHelperName;
;
var vRetVal = window.showModalDialog( "TakeControlMsgs.htm", vArgs, "dialogwidth:405px;dialogHeight:270px;status:no;resizeable:no;help:no" );
;
if( 0 == vRetVal)
{
;
try
{
if(null == g_objPanic)
{
;
g_objPanic = new ActiveXObject( "SAFRCFileDlg.Panic" );
}
;
g_objPanic.SetPanicHook(Stop_Control);
if(null != parent.oDeskMgr )
{
;
try
{
parent.oDeskMgr.SwitchDesktopMode( 1, nRAType );
}
catch(error)
{
parent.oDeskMgr.SwitchDesktopMode( 1 );
}
}
else
{
if( null == g_oDeskMgr )
{
;
g_oDeskMgr = oSAFClassFactory.CreateObject_RemoteDesktopManager();
}
;
try
{
parent.oDeskMgr.SwitchDesktopMode( 1, nRAType );
}
catch(error)
{
parent.oDeskMgr.SwitchDesktopMode( 1 );
}
}
frames.idFrameTools.idStopControl.disabled = false;
frames.idFrameTools.RejectId.disabled = false;
g_bRC = true;
Helpee_AcceptRC();
frames.idFrameTools.UpdateStatus( L_INCONTROL_Text );
var szMsg = L_TAKECONTROL1_Text + parent.gHelper + L_TAKECONTROL2_Text + g_szLocalUser + L_TAKECONTROL3_Text;
frames.idFrameChatTop.PrintTakeControlMsg( szMsg );
;
try
{
var oLogger = new ActiveXObject("RACplDlg.RAEventLog");
var args = new Array(2);
args[0] = parent.gHelper;
args[1] = g_szLocalUser;
oLogger.LogRemoteAssistanceEvent(0,3,args);
}
catch(e)
{
}
}
catch(error)
{
;
if(error.number == -2146828218)
{
;
Helpee_RejectRC( 2 );
}
else
{
Helpee_RejectRC( 3 );
FatalError( L_ERRSWITCHDESKTOPMODE_Text, error);
}
}
}
else
{
;
Helpee_RejectRC( 0 );
}
}
else
{
;
Helpee_RejectRC( 2 );
}
}
else if ( szCommandName == "REMOTECTRLEND" )
{
;
SoundBeep();
try
{
var oLogger = new ActiveXObject("RACplDlg.RAEventLog");
var args = new Array(2);
args[0] = parent.gHelper;
args[1] = g_szLocalUser;
oLogger.LogRemoteAssistanceEvent(0,4,args);
}
catch(e)
{
}
try
{
if(null != parent.oDeskMgr )
{
;
try
{
parent.oDeskMgr.SwitchDesktopMode( 0, nRAType );
}
catch(error)
{
parent.oDeskMgr.SwitchDesktopMode( 0 );
}
}
else
{
if( null == g_oDeskMgr )
{
;
g_oDeskMgr = oSAFClassFactory.CreateObject_RemoteDesktopManager();
}
;
try
{
parent.oDeskMgr.SwitchDesktopMode( 0, nRAType );
}
catch(error)
{
parent.oDeskMgr.SwitchDesktopMode( 0 );
}
}
frames.idFrameTools.UpdateStatus( L_SCREENVIEWONLY_Text );
frames.idFrameTools.idStopControl.disabled = true;
frames.idFrameTools.RejectId.disabled = true;
g_bRC = false;
if (null != g_objPanic)
{
;
g_objPanic.ClearPanicHook();
}
;
}
catch(error)
{
;
if(error.number != -2146828218)
{
FatalError( L_ERRSWITCHDESKTOPMODE_Text + error);
}
}
}
else if( szCommandName == "ABORTRC")
{
var szMsg = L_ERRTAKECONTROL3_Text + parent.gHelper + L_ERRTAKECONTROL4_Text + parent.gHelper + L_ERRTAKECONTROL5_Text;
DisplayMessage( szMsg );
}
else if ( szCommandName == "HIDECHAT" )
{
g_bChatBoxHidden = false;
frames.idFrameTools.Helpee_HideChat();
}
else if ( szCommandName == "SHOWCHAT" )
{
g_bChatBoxHidden = true;
frames.idFrameTools.Helpee_HideChat();
}
else if (szCommandName == "VOIPPREGO")
{
;
SoundBeep();
if (false == g_bVoIPEnabled)
return;
try
{
alert(L_64DISABLED_Text);
Helpee_SendControlCommand( "VOIPQNO" );
return;
var vArgs = new Array(1);
vArgs[0] = L_VOIPSTART_Text;
var vRetVal = window.showModalDialog( "hcp://system/Remote Assistance/Interaction/Common/VOIPMsgs.htm", vArgs, "dialogwidth:405px;dialogHeight:165px;status:no;resizable:no;help:no" );
if( 0 == vRetVal)
{
var szTemp = null;
try
{
try
{
var oICFAllowList = oSAFClassFactory.CreateObject_ICFAllowList();
oICFAllowList.Add();
}
catch(error)
{
}
var bShieldedMode = true;
bShieldedMode = !(CanOpenPort("\\pchealth\\helpctr\\binaries\\helpctr.exe", 0));
if (bShieldedMode)
{
ShowVoiceHelp();
Helpee_SendControlCommand( "VOIPQNO" );
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
g_bStartEnabled = true;
}
else
{
szTemp = g_Helpee_oSAFIntercomServer.Listen();
g_StartTalking = 0;
Helpee_TransmitVoipGo("VOIPVER2", szTemp);
}
}
catch (e)
{
Helpee_onVoiceDisabled(); }
}
else
{
Helpee_SendControlCommand( "VOIPQNO" );
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
g_bStartEnabled = true;
}
}
catch (error)
{
FatalError( L_RCCTL_Text, error );
;
return;
}
}
else if (szCommandName == "VOIPQNO")
{
;
SoundBeep();
if (false == g_bVoIPEnabled)
{
;
return;
}
try
{
g_StartTalking = 1;
DisplayMessage( L_ERRVOIP1_Text );
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
g_bStartEnabled = true;
}
catch (e)
{
FatalError(L_RCCTL_Text, e );
;
return;
}
}
else if (szCommandName == "VOIPGONO")
{
;
SoundBeep();
if (false == g_bVoIPEnabled)
{
;
return;
}
try
{
DisplayMessage( L_ERRVOIP1_Text );
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
g_bStartEnabled = true;
}
catch (e)
{
FatalError( L_RCCTL_Text, e );
return;
}
}
else if (szCommandName == "VOIPGOFAIL")
{
;
SoundBeep();
if (false == g_bVoIPEnabled)
{
;
return;
}
try
{
DisplayMessage( L_ERRVOIP1_Text );
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
g_bStartEnabled = true;
}
catch (e)
{
FatalError( L_RCCTL_Text, e );
}
}
else if (szCommandName == "VOIPPREGO2")
{
if (false == g_bVoIPEnabled)
{
;
return;
}
try
{
var szTemp = null;
szTemp = g_Helpee_oSAFIntercomServer.Listen();
Helpee_TransmitVoipGo("VOIPVER2", szTemp);
}
catch (e)
{
Helpee_onVoiceDisabled();
}
}
else if (szCommandName == "PRESTARTYES")
{
if (false == g_bVoIPEnabled)
return;
if (false == g_bVoipConnected)
{
try
{
Helpee_SendControlCommand ( "VOIPPREGO" );
}
catch (e)
{
FatalError( L_RCCTL_Text, e );
;
return;
}
}
else
{
try
{
g_Helpee_oSAFIntercomServer.Disconnect();
}
catch (e)
{
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
g_bStartEnabled = true;
}
}
}
else if (szCommandName == "PRESTARTNO")
{
if (false == g_bVoIPEnabled)
{
;
return;
}
try
{
g_bStartEnabled = true;
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
}
catch (error)
{
FatalError( L_RCCTL_Text, error );
;
return;
}
}
else if (szCommandName == "PRESTART")
{
if (false == g_bVoIPEnabled)
return;
try
{
frames.idFrameTools.btnVoice.disabled = true;
frames.idFrameTools.txtVoice.disabled = true;
if (false == g_bStartEnabled )
{
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
Helpee_SendControlCommand ( "PRESTARTNO" );
}
else
{
Helpee_SendControlCommand ( "PRESTARTYES" );
}
}
catch ( error )
{
FatalError( L_RCCTL_Text, error );
;
return;
}
}
else if (szCommandName == "DISABLEVOICE")
{
;
SoundBeep();
try
{
if (g_bVoIPEnabled == true)
{
DisplayMessage( L_ERRVOIP2_Text );
g_bVoIPEnabled = false;
g_stateVoipYou = 2;
frames.idFrameTools.btnVoice.disabled = true;
frames.idFrameTools.txtVoice.disabled = true;
}
}
catch ( error )
{
FatalError( L_RCCTL_Text, error );
;
return;
}
}
else if (szCommandName == "WIZARDGOOD")
{
try
{
g_stateVoipYou = 1;
if ( (g_stateVoipYou < 2) && (g_stateVoipMe < 2) )
{
g_bVoIPEnabled = true;
frames.idFrameTools.btnVoice.disabled = false;
frames.idFrameTools.txtVoice.disabled = false;
}
}
catch (error)
{
FatalError( L_RCCTL_Text, error );
;
return;
}
}
else if (szCommandName == "WIZARDBAD")
{
;
SoundBeep();
try
{
g_bVoIPEnabled = false;
DisplayMessage( L_ERRVOIP2_Text );
g_stateVoipYou = 2;
frames.idFrameTools.btnVoice.disabled = true;
frames.idFrameTools.txtVoice.disabled = true;
}
catch (error)
{
FatalError( L_RCCTL_Text, error );
;
return;
}
}
else if ( szCommandName == "HELPERVERSION" )
{
if( true == false )
{
var szSchemaVersion = null;
var szControlChannelVersion = null;
try
{
szSchemaVersion = RCCommand.getAttribute( "SCHEMAVERSION" );
if( szSchemaVersion != "5.1" )
{
FatalError(L_ERRSCHEMAVERSION_Text);
;
return;
}
}
catch(error)
{
FatalError(L_ERRSCHEMAVERSION_Text);
;
return;
}
try
{
szControlChannelVersion = RCCommand.getAttribute( "CONTROLCHANNELVERSION" );
if( szControlChannelVersion != "5.1" )
{
FatalError(L_ERRCHANNELVERSION_Text);
;
return;
}
}
catch(error)
{
FatalError(L_ERRSCHEMAVERSION_Text);
;
return;
}
}
}
else if (szCommandName == "BANDWTOHIGH")
{
g_VoipBandwidth = 1;
g_Helpee_oSAFIntercomServer.SamplingRate = 2;
}
else if (szCommandName == "BANDWTOLOW")
{
g_VoipBandwidth = 0;
g_Helpee_oSAFIntercomServer.SamplingRate = 1;
}
else if( szCommandName == "TYPINGSTART" )
{
frames.idFrameTools.UpdateChatStatus( L_EXPERTTYPING_Text );
}
}
catch(error)
{
FatalError( L_ERRFATAL_Text, error );
}
;
return;
}
function Helpee_SendControlCommand( szCommandName )
{
;
var Doc = null;
var RCCommand = null;
try
{
Doc = new ActiveXObject("microsoft.XMLDOM");
RCCommand = Doc.createElement( "RCCOMMAND" );
RCCommand.setAttribute( "NAME", szCommandName );
g_Helpee_oControlChannel.SendChannelData( RCCommand.xml );
}
catch(error)
{
FatalError( L_RCCTL_Text, error );
}
;
return;
}
function Helpee_TransmitVoipGo(version, szTemp)
{
;
var Doc = null;
var RCCommand = null;
var szVoipKey = null;
var szVoipIPList = null;
var i = 0;
try
{
i = szTemp.indexOf(";")
if (i == -1)
{
szVoipKey = szTemp;
szVoipIPList = null;
}
else
{
szVoipKey = szTemp.slice(0,i);
szVoipIPList = szTemp.slice(i+1);
}
Doc = new ActiveXObject("microsoft.XMLDOM");
RCCommand = Doc.createElement( "RCCOMMAND" );
RCCommand.setAttribute( "NAME", "VOIPGO" );
RCCommand.setAttribute( "VOIPVER", version );
RCCommand.setAttribute( "VOIPGOKEY", szVoipKey );
RCCommand.setAttribute( "VOIPIPLIST", szVoipIPList );
g_Helpee_oControlChannel.SendChannelData( RCCommand.xml );
}
catch (e)
{
FatalError( L_ERRFATAL_Text, e );
}
;
return;
}
function Helpee_TransmitScreenInfo()
{
;
var Doc = null;
var RCCommand = null;
try
{
Doc = new ActiveXObject("microsoft.XMLDOM");
RCCommand = Doc.createElement( "RCCOMMAND" );
RCCommand.setAttribute( "NAME", "SCREENINFO" );
RCCommand.setAttribute( "WIDTH", screen.width );
RCCommand.setAttribute( "HEIGHT", screen.height );
RCCommand.setAttribute( "COLORDEPTH", screen.colorDepth );
RCCommand.setAttribute( "SCHEMAVERSION", "5.1" );
RCCommand.setAttribute( "CONTROLCHANNELVERSION", "5.1" );
g_Helpee_oControlChannel.SendChannelData( RCCommand.xml );
}
catch(error)
{
FatalError( L_ERRFATAL_Text, error );
}
;
return;
}
function Stop_Control()
{
try
{
try
{
var oLogger = new ActiveXObject("RACplDlg.RAEventLog");
var args = new Array(2);
args[0] = parent.gHelper;
args[1] = g_szLocalUser;
oLogger.LogRemoteAssistanceEvent(0,4,args);
}
catch(e)
{
}
Helpee_SendControlCommand( "ESCRC" );
try
{
try
{
parent.oDeskMgr.SwitchDesktopMode( 0, nRAType );
}
catch(error)
{
parent.oDeskMgr.SwitchDesktopMode( 0 );
}
frames.idFrameTools.UpdateStatus( L_SCREENVIEWONLY_Text );
}
catch(error)
{
Helpee_RejectRC( 3 );
FatalError( L_ERRSWITCHDESKTOPMODE_Text , error);
}
frames.idFrameTools.idStopControl.disabled = true;
frames.idFrameTools.RejectId.disabled = true;
if (null != g_objPanic)
{
g_objPanic.ClearPanicHook();
}
idCtx.minimized = false;
idCtx.bringToForeground();
var vArgs = new Array(1);
vArgs[0] = parent.gFrom + L_OR_Text + parent.gHelperName + L_ESCHIT_Text;
var vRetVal = window.showModelessDialog( "hcp://system/Remote Assistance/Interaction/Common/ErrorMsgs.htm", vArgs, "dialogwidth:405px;dialogHeight:165px;status:no;resizable:no;help:no" );
AddOpenSubWin( vRetVal );
}
catch(error)
{
Helpee_RejectRC( 3 );
FatalError( L_ERRFATAL_Text, error );
}
}
function Helpee_RejectRC( mode )
{
;
try
{
if( false == g_bConnected )
{
;
return;
}
switch (mode) {
case 0:
Helpee_SendControlCommand( "REJECTRC" );
break;
case 1:
try
{
var oLogger = new ActiveXObject("RACplDlg.RAEventLog");
var args = new Array(2);
args[0] = parent.gHelper;
args[1] = g_szLocalUser;
oLogger.LogRemoteAssistanceEvent(0,4,args);
}
catch(e)
{
}
Helpee_SendControlCommand( "TAKECONTROL" );
try
{
try
{
parent.oDeskMgr.SwitchDesktopMode( 0, nRAType );
}
catch(error)
{
parent.oDeskMgr.SwitchDesktopMode( 0 );
}
frames.idFrameTools.UpdateStatus( L_SCREENVIEWONLY_Text );
}
catch(error)
{
FatalError( L_ERRSWITCHDESKTOPMODE_Text , error);
}
if (null != g_objPanic)
{
g_objPanic.ClearPanicHook();
}
break;
case 2:
Helpee_SendControlCommand( "DENIEDRC" );
var vArgs = new Array(1);
vArgs[0] = L_ERRRCPERMDENIED_Text;
var vRetVal = window.showModelessDialog( "hcp://system/Remote Assistance/Interaction/Common/ErrorMsgs.htm", vArgs, "dialogwidth:405px;dialogHeight:165px;status:no;resizable:no;help:no" );
AddOpenSubWin( vRetVal );
break;
case 3:
Helpee_SendControlCommand( "ERRORRC" );
break;
}
frames.idFrameTools.idStopControl.disabled = true;
frames.idFrameTools.RejectId.disabled = true;
}
catch(error)
{
FatalError( L_ERRFATAL_Text, error );
}
;
return;
}
function Helpee_AcceptRC()
{
;
try
{
Helpee_SendControlCommand( "ACCEPTRC" );
}
catch(error)
{
FatalError( L_ERRFATAL_Text, error );
}
;
return;
}
</SCRIPT>
<script language="vbscript">
function CanOpenPort(AppName, PortNumber)
dim ShellObj
Set ShellObj = CreateObject("WScript.Shell")
AppName = ShellObj.ExpandEnvironmentStrings("%windir%") & AppName
dim FirewallManager
Set FirewallManager = CreateObject("HNetCfg.FwMgr")
dim NET_FW_IP_VERSION_ANY
NET_FW_IP_VERSION_ANY = 2
dim NET_FW_IP_PROTOCOL_TCP
NET_FW_IP_PROTOCOL_TCP = 6
dim IPAddress
dim AppAllowed, PortRestricted
AppAllowed = false
PortRestricted = false
FirewallManager.IsPortAllowed AppName, NET_FW_IP_VERSION_ANY, PortNumber, IPAddress, NET_FW_IP_PROTOCOL_TCP, AppAllowed, PortRestricted
if AppAllowed = True and PortRestricted = False then CanOpenPort = true else CanOpenPort = false
End Function
</script>
<BODY id="idBody" name="idBody" onload='DoLoad();' bgcolor="LightGrey" scroll=no tabindex=-1>
</BODY>
</HTML>