p.window.g_bOsPersonal ? L_Personal_Message : L_Pro_Message) + (oUser.isPasswordResetAvailable ? L_Backup_Message : L_NoBackup_Message);
idResetWarning.innerHTML = strReset.replace(/%1/g, szName);
}
idNewPassword1Input.focus();
}
function ApplyPasswordChange()
{
var szNewPassword1 = GetText(idNewPassword1Input);
var szNewPassword2 = GetText(idNewPassword2Input);
if (szNewPassword1 == szNewPassword2)
{
var oUser = top.window.g_oSelectedUser;
var bSelf = top.window.IsSelf();
var bOldPW = oUser.passwordRequired;
var nErr = 0;
try
{
oUser.changePassword(szNewPassword1, (bSelf && bOldPW) ? GetText(idOldPasswordInput) : "");
oUser.setting("Hint") = GetText(idHintInput);
}
catch (e)
{
nErr = (e.number & 0xffff);
}
if (0 == nErr)
{
if (top.window.g_szInitialTask != "ChangePassword" &&
bSelf && !bOldPW &&
top.window.g_bRunningAsOwner)
{
var bPrivate = false;
var bCanMakePrivate = true;
try
{
bPrivate = oUser.isProfilePrivate;
}
catch (e)
{
bCanMakePrivate = false;
}
if (bCanMakePrivate && !bPrivate)
{
top.window.g_Navigator.navigate("passwordpage2.htm");
return;
}
}
top.window.g_Navigator.navigate("mainpage.htm", true);
}
else
{
idNewPassword1Input.value = '';
idNewPassword2Input.value = '';
idHintInput.value = '';
idNewPassword1Input.focus();
var strMsg = top.window.L_ChangePassword_ErrorMessage;
switch (nErr)
{
case 86: 
case 1323: 
if (bSelf && bOldPW)
{
idOldPasswordInput.value = '';
idOldPasswordInput.focus();
strMsg = top.window.L_InvalidPassword_Message;
}
break;
case 1324: 
case 1325: 
case 1327: 
case 2243: 
case 2244: 
case 2245: 
case 2246: 
strMsg = top.window.L_PasswordTooShort_Message;
break;
}
alert(strMsg);
}
}
else
{
idNewPassword1Input.value = '';
idNewPassword2Input.value = '';
idNewPassword1Input.focus();
alert(top.window.L_PasswordMismatch_Message);
}
}
