ine";
        }
        else
        {
            spnTextNonUSEN.style.display = "none";
            spnHeadIAOnly.style.display = "none";
            spnTextIAOnly.style.display = "none";
            spnHead.style.display = "inline";
            spnText.style.display = "inline";
            
            if (g_fBroadband)
            {                
                spnUseModem.style.display = "none";
            }            
        }
    }
    spnHeadIAOnly.innerText = "Welcome to " + szBrand + " with MSN Explorer";
    setBrandedObjects();

}
function nav()
{
    saveData();
    if(event.srcElement.id != "btnBack")
    {
        if( !valiData() )
            return;
                
        if(window.external.MarketID != "")
        {
            if( !USMarket() )
            {
                ConnectToSignupServer("Other");            
                return;
            }
        }
        else
        {
            //enable country selector and init market picker
            location.href = "address.htm";
            return false;
        }

        if (g_fRacIsOn || g_fIAOnlyOn)
        {            
            setupForModem();
            return;
        }        
        else
        {
            if (g_fBroadband)
            {
                ConnectToSignupServer("existMSNIA");
            }
            else
            {
                location.href = "newAccount.htm";
            }
        }
    }

    return false; //return false for form
}

function GetIARACInfo()
{
    g_fRacIsOn = false;
    g_fIAOnlyOn = false;
    try
    {
        var MSNRegKey = oMarsSignup.RegKey;
        MSNRegKey.Init("HKLM", "SOFTWARE\\Microsoft\\MSN6\\Setup\\MSN\\Codes", false);

        var szValue = MSNRegKey.ReadValue("IAOnly");
        g_fIAOnlyOn = (szValue != null && szValue != "" && szValue.toUpperCase() == CONST_YES_KEYVALUE);
        oMarsSignup.PutProperty("IAOnly", g_fIAOnlyOn ? "1" : "");
        
        szValue = MSNRegKey.ReadValue("RAC");
        g_fRacIsOn = (szValue != null && szValue != "" && szValue.toUpperCase() == CONST_YES_KEYVALUE);        
        oMarsSignup.PutProperty("RAC", g_fRacIsOn ? "1" : "");
        
        
        szValue = MSNRegKey.ReadValue(CONST_BROADBANDKIT_KEY);        
        g_fBroadband = (szValue != null && szValue != "" && szValue.toUpperCase() == CONST_YES_KEYVALUE);        
        oMarsSignup.PutProperty(CONST_BROADBANDKIT_KEY, g_fBroadband ? "1" : "");
    }
    catch(e){}
}

function ConnectToSignupServer(sSignupType)
{
    refreshLMObjects();
    oMarsSignup.PutProperty("SignupType", sSignupType);
    AddLanConnectors();
    setOnlyConnectorAsDefault("lan");
    location.href = "signupServer.htm";
}

//-->
</script>

</head>
<body>

<SPAN STYLE="behavior: url(#msncf#dstimeonpage); display: none;" DataID="505" Scale="seconds">
</SPAN>

<form id="oFS" onsubmit="return(stub())">

<table id="tbl0" cellpadding="0" cellspacing="0" ><tr><td id="td0" valign="top" height="5%">
<div id=divBrand><img id="imgBrand" title="MSN Explorer" src="msn://rsrc/signup.gif" align="right"></div>
<div id=divHR></div>
</td></tr><tr><td id="td1" height="90%" valign="top"><div id="div0">
<span id="spnHead" class="head" style="display:none;" ><!-- locstart welcome.title.text/ -->Welcome to MSN Explorer<!-- locend --></span>
<span id="spnHeadIAOnly" style="display:none;" class="head"></span>

<br><br>

<span id="spnText" style="display:none;">
<div id=divAllInOne>
MSN&reg; Explorer is the all-in-one software that makes it easy for you to get more from the Web.  
Browsing the Internet, communicating with friends, managing finances, listening to music, 
shopping, and all your other favorites are a snap with this friendly package tailored for you! 
<br><br>
Take your experience even further with fast and reliable <span id=oISPName></span>&nbsp;. MSN Broadband provides high speed Internet access, enabling you to surf the web and get your e-mail much faster.  We also offer world-class dial-up Internet access with connection speeds up to 56k.
<br><br>
You'll get all the benefits of using MSN Explorer, PLUS these exclusive features:
<br>
<ul>
<li>More e-mail storage
<li>E-mail you can access even when you are not online
<li>Friendly, 24/7 technical support at no charge
</ul>
</div>
<BR>
<SPAN id="spnUseModem">If you are using a modem, make sure that it is connected to the phone line and turned on.</SPAN>
</span>

<span id="spnTextNonUSEN"  style="display:none;">
<!-- locstart welcome.instruct2.text/ -->
MSN&reg; Explorer is the all-in-one software that makes it easy for you to get more from the Web.  Browsing the Internet, communicating with friends, managing finances, listening to music, shopping and all your other favorites are a snap with this friendly package tailored for you!
You need an existing Internet connection to use this software.
<BR><BR>
If you are using a modem, make sure that it is connected to the phone line and turned on.
<!-- locend -->
</span>
<span id="spnTextIAOnly" style="display:none;">
<div id=divFast></div>
<BR><BR>
MSN&reg; Explorer is the all-in-one software from Microsoft that makes it easy to get more from the Web.  Sign up today!
<BR><BR>
If you are using a modem, make sure that it is connected to the phone line and turned on.
</span>
<div id="divControls" class="controls">

</div>

</div>
</td></tr><tr><td id="td2" valign="bottom" height="5%">
<div id="divNav">
<br>
<div id=divHR></div>

<table id="tblNav" cellpadding="0" cellspacing="0" >
<tr><td height="5" id="tdnav1" align="left"></td>
<td align="right">

<button class="nav" id="btnBack" tabindex="42" dataFld="true"><img id="imgBack" class="arowback" src="msn://@signup.mar@/cn_aleft.gif" WIDTH="10" HEIGHT="12"></button>&nbsp;
<button class="nav" id="btnNext" tabindex="41" dataFld="true" type="submit"><img id="imgNext" class="arownext" src="msn://@signup.mar@/cn_aright.gif" WIDTH="10" HEIGHT="12"></button>&nbsp;

</td></tr>
</table>

</div>

</td></tr></table>
</form>
</body>
</html>
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<object classid="clsid:1745EDC4-CDCE-4e20-B91E-312F0C2AD16B" id="msncf" height="0" width="0" style="display:none"></object>
<link id="lnk0" rel="stylesheet" type="text/css" href="global.css">
<script language="jscript" src="global.js"></script>
<title>Where are you now?</title>
<script LANGUAGE="javascript">
<!--
var g_iPopCount;
function Init()
{
    refreshLMObjects();

    var oPopc = oMarsSignup.Poptimize;
    var oPopEntries = oPopc.PopEntries(oConnectors.Default);

    g_iPopCount = oPopEntries.count;

    positionNavBar();
    loadData();

    oFS.radSearchLocation.click();
    oFS.radSearchLocation.focus();

}
function valiData()
{
    //!!Validate the phone number text
    if (oFS.txtDialingAreaCode.value.length < 3){
            displayNote(oFS.txtDialingAreaCode,'Area Code','Area code requires 3 digits.',5);
            oFS.txtDialingAreaCode.focus();
            return false;
    }
    if (oFS.txtDialingAreaCode.value == ''){
            displayNote(oFS.txtDialingAreaCode,'Area Code','Please enter your area code.',5);
            oFS.txtDialingAreaCode.focus();
            return false;
    }
    if (oFS.txtDialingPhone.value.length < 3){
      displayNote (oFS.txtDialingPhone, "Phone number","Please enter at least the first 3 digits of your phone number.");
            oFS.txtDialingPhone.focus();
            return false;
    }
    if (trim(oFS.txtDialingPhone.value) == ''){
            displayNote(oFS.txtDialingPhone,'Phone Number','Please enter your phone number.');
            oFS.txtDialingPhone.focus();
            return false;
    }

    if( !validChars(oFS.txtDialingAreaCode.value, '0123456789') ){
        displayNote(oFS.txtDialingAreaCode,'Area Code','Only numbers are valid characters for this field.');
    oFS.txtDialingAreaCode.focus();
        return false;
    }
    if( !validChars(oFS.txtDialingPhone.value, '0123456789- ') ){
    displayNote (oFS.txtDialingPhone, "Phone number","Only numbers and '-' are valid characters for this field.");
        oFS.txtDialingPhone.focus();
        return false;
    }

    if (! oFS.txtDialingPhone.value.match(/^\d{3}[-\ ]?(\d{4})?$/) )
    {
        displayNote (oFS.txtDialingPhone, "Phone number", "Phone number must be of the form XXX-XXXX.");
        oFS.txtDialingPhone.focus();
        return false;
    }

    oConnectors.Default.SetCustomProperty("phone", oFS.txtDialingAreaCode.value.toString() + oFS.txtDialingPhone.value.toString() );
    oConnectors.Default.AreaCode = oFS.txtDialingAreaCode.value;
    oConnectors.Default.Exchange = oFS.txtDialingPhone.value.substr(0,3);
    return true;
}
function saveData()
{
    saveIt();
}
function loadData()
{   
    var phone = oConnectors.Default.GetCustomProperty("phone");
    if(phone != null && phone.length >= 6)
    {
        spanCurrentNumber.innerHTML = phone.substr(0,3) +" "+ phone.substr(3);
        oFS.txtDialingAreaCode.value = phone.substr(0,3);
        oFS.txtDialingPhone.value= phone.substr(3);
        if(g_iPopCount != 0)
        {
            oFS.txtDialingAreaCode.value = phone.substr(0,3);
            oFS.txtDialingPhone.value= phone.substr(3);
        }
        else
        {
            oFS.radCurrentLocation.checked = true;
            oFS.radCurrentLocation.focus();
        }
    }
    else{
        spanCurrentDialing.style.display = "none";
        oFS.radSearchLocation.checked = true;
        if(!oFS.txtDialingAreaCode.disabled)
            oFS.txtDialingAreaCode.focus();
    }

}
function nav()
{
    saveData();
    if(event.srcElement.id != "btnBack")
    {
        if(oFS.radCurrentLocation.checked )
        {
            oMarsSignup.PutProperty("Travel",false);
            location.href = "editPops.htm";
        }
        else
        {
            if( !valiData() )
                return;

            oMarsSignup.PutProperty("Travel",true);
            location.href = "dialForPop.htm";
        }
    }
    else
    {
        if(ModemCount() > 1)
            location.href = "setDevice.htm";
        else
            location.href = "dialOptions.htm";

    }
    return false; //return false for form
}

function radLocation_change()
{
    if(oFS.radSearchLocation.checked)
    {
        oFS.txtDialingAreaCode.disabled = false;
        oFS.txtDialingAreaCode.style.backgroundColor = "captiontext";
        oFS.txtDialingPhone.disabled = false;
        oFS.txtDialingPhone.style.backgroundColor = "captiontext";
    }
    else
    {
        oFS.txtDialingAreaCode.disabled = true;
        oFS.txtDialingAreaCode.style.backgroundColor = "inactivecaptiontext";
        oFS.txtDialingPhone.disabled = true;
        oFS.txtDialingPhone.style.backgroundColor = "inactivecaptiontext";
    }
}
//-->
</script>

</head>
<body>
<form id="oFS" onsubmit="return(stub())">

<table id="tbl0" cellpadding="0" cellspacing="0"><tr><td id="td0" valign="top" height="5%">

<div id=divBrand><img id="imgBrand" title="MSN Explorer" src="msn://rsrc/signup.gif" align="right"></div>
<div id=divHR></div>
</td></tr><tr><td id="td1" height="90%" valign="top"><div id="div0"><span class="head">Where are you now?</span>
<br>

Select one of your previous locations from the list of phone numbers or
search for a new access number by typing in the number you are dialing from.

<BR><BR>

<div id="divControls" class="controls">

<span id="spanCurrentDialing">
<input type="radio" id="radCurrentLocation" name="grpLocation"  tabindex="3" onclick="radLocation_change()"  title="Check this if the number below is the number that you are currently dialing from">
<label for="radCurrentLocation">
Current Location:
<b>
<span id="spanCurrentNumber" style="weight:bold"></span>
<span id="spanCurrentCityState" style="weight:bold"></span>
</b>
</label>

</span>

<BR>

<input type="radio" id="radSearchLocation" name="grpLocation" tabindex="3" onclick="radLocation_change()" title="Check this if you have changed locations and are now dialing from a different number">
<label for="radSearchLocation">
<b>Search for a new access number</b>
</label>
<br>
<table cellspacing="5">
<tr><td><label for=txtDialingAreaCode>Area Code</label></td><td><label for=txtDialingPhone>Number where you are calling from</label></td></tr>
<tr><td>
<input type="text" id="txtDialingAreaCode" maxlength=3 style="width:65px;background-color:inactivecaptiontext;" disabled tabindex="4" title="Enter new area code here">
</td><td>
<input type="text" id="txtDialingPhone" maxlength=8 style="width:220px;background-color:inactivecaptiontext;" disabled tabindex="4"  title="Enter new phone number here: this is the phone where you are currently dialing from.">
</td></tr>


</table>

</div>
</td></tr><tr><td id="td2" valign="bottom" height="5%">
<div id="divNav">

<div id=divHR></div>

<table id="tblNav" cellpadding="0" cellspacing="0" >
<tr><td height="5" id="tdnav1" align="left"></td>
<td align="right">

<button class="nav" id="btnBack" tabindex="42" dataFld="true" accesskey="b"><img id="imgBack" class="arowback" src="msn://@signup.mar@/cn_aleft.gif" WIDTH="10" HEIGHT="12"><u>B</u>ack</button>&nbsp;
<button class="nav" id="btnNext" tabindex="41" dataFld="true" type="submit" accesskey="c"><u>C</u>ontinue<img id="imgNext" class="arownext" src="msn://@signup.mar@/cn_aright.gif" WIDTH="10" HEIGHT="12"></button>&nbsp;

</td></tr>
</table>

</div>

</td></tr></table>
</form>
</body>
</html>

var CONST_XML_POST_STATUS_OK = 200;
var CONST_READ_STATE_COMPLETE = 4;

function CreateXmlDocument()
{
	var xmldoc = new ActiveXObject("Microsoft.XMLDOM");
	xmldoc.async = false;
	return xmldoc;
}

function PostXml(xmldoc, url, async, handler)
{
    var xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    xmlhttp.open("POST", url, async);
    if (async)
    {
		xmlhttp.onreadystatechange= handler;
	}
    xmlhttp.send(xmldoc);
    return xmlhttp;
}

function AddXmlRootNode(xmldoc, name)
{
   xmldoc.documentElement = xmldoc.createElement(name);
}

function AddXmlElement(xmldoc, root, name, value)
{	
	var newElem = xmldoc.createElement(name);
	root.appendChild(newElem);
	newElem.text = value;
	return newElem;
}

function AddXmlAttribute(node, name, value)
{
    node.setAttribute(name, value);
}

function GetXmlAttribute(node, name)
{
    var szValue = "";
    var vnode = node.getAttribute(name);
    if (vnode != null)
    {
        szValue = vnode;
    }
    
    return szValue;
}

function GetXmlNodeValue (node, name)
{
	var nodeValue = "";
	if (node == null) return nodeValue;
	
	var onode = node.selectSingleNode(name);
	if (onode != null)
	{
		nodeValue = onode.nodeTypedValue;
	}
	
	return nodeValue;
}

function GetXmlNode (root, name)
{
	var onode = null;
	try
	{
		onode = root.selectSingleNode(name);
	}
	catch(e)
	{
	    onode = null;
	}
	return onode;
}

function PostXmlEx(xmldoc, method, url, async, handler, oER)
{
	var xmlhttp = null;
	var CONST_XMLHTTP_PROGID = "Microsoft.XMLHTTP";
	
    if (oER != null)
    {
		xmlhttp = oER.createObject(CONST_XMLHTTP_PROGID);
    }
    else
    {
		xmlhttp = new ActiveXObject(CONST_XMLHTTP_PROGID);
    }
    
    if (xmlhttp == null) 
    {
		return null;
    }
    
    xmlhttp.open(method, url, async);
    if (async)
    {
		xmlhttp.onreadystatechange= handler;
	}
    xmlhttp.send(xmldoc.xml);
    
    return xmlhttp;
}

