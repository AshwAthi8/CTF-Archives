  oMarsSignup.PutProperty("Upgrade","");
    oMarsSignup.PutProperty("SignupType","");
    loadData();
    refreshView();

}

function loadData()
{
    var oConnector = oConnectors.Default;
    if( !isIAUserPresent() )
    {
        setOnlyConnectorAsDefault("lan");
        spanCurrentConnection.innerHTML = VisuallyFormatConnector(oConnector);
        oFS.radDialOptions.disabled = true;
        oFS.radChangeLocation.disabled = true;
        oFS.radChangeHow.checked = true;
    }
    else if(oConnector.DeviceType.toLowerCase() == "modem")
    {
        spanDevice.innerHTML = "modem";
        var oPop = oMarsSignup.Poptimize;
        var oPopEntries = oPop.GetPopEntries(oConnector);

        var fNumberFound = false;
        for (var i = 0; i < oPopEntries.Count; ++i)
        {
            var oPopEntry = oPopEntries.item(i);
            if (oPopEntry.IsDialed())
            {
                spanNumber.innerHTML = VisuallyFormatNumber(oPopEntry.Number, oPopEntry.Flags | oConnector.DialingFlags);
                fNumberFound = true;
                break;
            }
        }
        
        if (!fNumberFound && (oPopEntries.Count > 0))
        {
            var oPopEntry = oPopEntries.item(0);
            spanNumber.innerHTML = VisuallyFormatNumber(oPopEntry.Number, oPopEntry.Flags | oConnector.DialingFlags);
        }

        oFS.radDialOptions.checked = true;
    }
    else
    {
        oFS.radDialOptions.disabled = true;
        oFS.radChangeLocation.disabled = true;
        oFS.radChangeHow.checked = true;
        spanCurrentConnection.innerHTML = VisuallyFormatConnector(oConnector);
    }

}

function valiData()
{
    return true;
}
function dialOptions()
{
    setupForModem();
}
function changeLocation()
{
    oMarsSignup.PutProperty("Travel",true);
    setupForModem();
}
function changeHowConnect()
{
    location.href = "howYouConnect.htm";
}

function nav()
{
    if(event.srcElement.id != "btnBack")
    {
        if( !valiData() )
            return;

        if(oLM.CurrentConnector != null)
        {
            if(oLM.CurrentConnector.ConnectionStatus == STATUS_CONNECTED)
                 oMarsSignup.DisconnectSignup(true);
        }
        if(oFS.radDialOptions.checked)
            dialOptions();
        else if(oFS.radChangeLocation.checked)
            changeLocation();
        else if(oFS.radChangeHow.checked)
            changeHowConnect();

    }
    else
    {
        oMarsSignup.CloseSignupWindow();
    }
    
    return false; //return false for form
}

function refreshView()
{
    for(i=0;i<2;i++)
    {
        if(oFS.radDialOptions.disabled)
            spanopt1[i].style.color = "silver";

        if(oFS.radChangeLocation.disabled)
            spanopt2[i].style.color = "silver";

        if(oFS.radChangeHow.disabled)
            spanopt3[i].style.color = "silver";
    }
    
}

//-->
</script>

</head>
<body>
<form id="oFS" onsubmit="return(stub())">

<table id="tbl0" cellpadding="0" cellspacing="0"><tr><td id="td0" valign="top" height="5%">

<div id=divBrand><img id="imgBrand" title="MSN Explorer" src="msn://rsrc/signup.gif" align="right"></div>
<div id=divHR></div>
</td></tr><tr><td id="td1" height="90%" valign="top"><div id="div0">
<span class="head">
<!-- locstart changeconn.title.text/ -->Connection Settings<!-- locend -->
</span>
<br>
<span class="bluesubhead">
<!-- locstart changeconn.currentconnection.info/explains the device connecting with -->
You're connecting to the Internet through:
<!-- locend -->
<br>

<span id="spanCurrentConnection">

<span id=spanDevice></span> &nbsp; <!--locstart changeconn.dialingtext.info-->dialing<!--locend--> &nbsp; <span id=spanNumber></span>

</span>
</span>

<BR><BR>

<table cellpadding="2" cellspacing="2" border="0">

<tr id="trDialSettings"><td valign="top">
<input type="radio" id="radDialOptions" name="grpConnSettings" >
</td><td>
<label for="radDialOptions" accesskey="D">
<span class="bluesubhead" id="spanopt1">
<!-- locstart changeconn.dialingoptions.label/label to change dialing options-->
Change <U>d</U>ialing options
<!-- locend -->
</span>
<br>
<span id="spanopt1">
<!-- locstart changeconn.dialingoptions.text/explanation to change dialing options-->
You can change long distance dialing settings,
disable call waiting or touch tone service, or specify how to get an outside line.
<!-- locend -->
</span>
</label>
</td></tr>

<tr><td class="spacer"></td></tr>

<tr id="trDialLocation"><td valign="top">
<input type="radio" id="radChangeLocation" name="grpConnSettings" >
</td><td id="tdopt2">
<label for="radChangeLocation" accesskey="L">
<span class="bluesubhead" id="spanopt2">
<!-- locstart changeconn.changelocation.label/label to change location -->
Change the <U>l</U>ocation you're dialing from
<!-- locend -->
</span>
<br>
<span id="spanopt2">
<!-- locstart changeconn.changelocation.text/explanation of option to change location-->
Choose this if you've moved, or are traveling with your computer.
<!-- locend -->
</span>
</label>
</td></tr>

<tr><td class="spacer"></td></tr>

<tr><td valign="top">
<input type="radio" id="radChangeHow" name="grpConnSettings" >
</td><td id="tdopt3">
<label for="radChangeHow" accesskey="H">
<span class="bluesubhead" id="spanopt3">
<!-- locstart changeconn.changehow.label/label to change how one connects to internet -->
Change <U>h</U>ow you connect to the Internet
<!-- locend -->
</span>
<br>
<span id="spanopt3">
<!-- locstart changeconn.changehow.text/explanation change how one connects to internet -->
Choose a different way to connect to the Internet
<!-- locend -->
</span>
</label>
</td></tr>

</table>

<div id="divControls" class="controls">

</div>

</div>
</td></tr><tr><td id="td2" valign="bottom" height="5%">
<div id="divNav">
<div id=divHR></div>

<table id="tblNav" cellpadding="0" cellspacing="0" >
<tr><td height="5" id="tdnav1" align="left"></td>
<td align="right">

<button class="nav" id="btnBack" tabindex="42" dataFld="true"><img id="imgBack" class="arowback" src="msn://@signup.mar@/cn_aleft.gif" WIDTH="10" HEIGHT="12"></button>&nbsp;
<button class="nav" id="btnNext" tabindex="41" dataFld="true" type="submit"><img id="imgNext" class="arownext" src="msn://@signup.mar@/cn_aright.gif" WIDTH="10" HEIGHT="12"></button>&nbsp;

</td></tr>
</table>

</div>

</td></tr></table>
</form>
</body>
</html>
GIF89a
