
}
if (("Text" == globalDoc.selection.type) ||
("None" == globalDoc.selection.type))
{
rngMaster = globalDoc.selection.createRange();
globalDoc.execCommand("AutoDetect");
elmLink = findAnchor(rngMaster);
if (null != elmLink)
{
rngLink = getTextRange(elmLink);
if (rngLink.compareEndPoints("StartToStart", rngMaster) < 0)
{
rngMaster.setEndPoint("StartToStart", rngLink);
}
if (rngLink.compareEndPoints("EndToEnd", rngMaster) > 0)
{
rngMaster.setEndPoint("EndToEnd", rngLink);
}
rngMaster.select();
if ("" != elmLink.href)
{
txtURL.value = elmLink.href;
txtURL.href = elmLink.href;
g_fURLLoaded = true;
btnOK.disabled = false;
}
updateProtocolSel();
}
txtURL.focus();
txtURL.select();
setOKState();
}
}
function IsRangeEmpty( range )
{
var tempRange;
tempRange = range.duplicate();
result = tempRange.compareEndPoints( "StartToEnd", range );
if ( result == 0 )
{
return true;
}
else
{
return false;
}
}
function btnOKClick()
{
var globalDoc = window.dialogArguments;
var cmdCreateLink = "CreateLink";
var cmdUnlink = "Unlink";
var range = globalDoc.selection.createRange();
var strSlashProts = " file:ftp:gopher:http:https:";
var strProtocol = selProtocol.value;
var dupRange;
var initialRange;
var iRight;
var fUseExecCommand = true;
if ("" == txtURL.value)
{
range.execCommand(cmdUnlink, false);
window.close();
return;
}
if (g_fURLLoaded && (txtURL.value == txtURL.href))
{
window.close();
return;
}
updateProtocolSel();
if (0 < strSlashProts.indexOf(strProtocol))
{
strProtocol = strProtocol + "//";
}
initialRange = range.duplicate();
if ( IsRangeEmpty( range ) )
{
range.text = txtURL.value;
fUseExecCommand = false;
}
else
{
dupRange = range.duplicate();
iRight = dupRange.moveEnd( "Character", 2 );
if ( iRight < 2 && dupRange.htmlText == "" )
{
range.text = txtURL.value;
fUseExecCommand = false;
}
}
if ( fUseExecCommand )
{
range.execCommand(cmdCreateLink, false, txtURL.value);
}
else
{
dupRange = range.duplicate();
dupRange.move( "Character", -1 );
elmParent = dupRange.parentElement();
if (elmParent.tagName == "A")
{
elmParent.href = txtURL.value;
}
else
{
range.setEndPoint( "StartToEnd", initialRange );
dupRange = range.duplicate();
dupRange.collapse(true);
elmParent = dupRange.parentElement();
if (elmParent.tagName == "A")
{
range.execCommand(cmdUnlink, false);
}
range.execCommand(cmdCreateLink, false, txtURL.value);
}
}
window.close();
}
</SCRIPT>
</HEAD>
<BODY id=bdy style="font-family: MS Shell Dlg; font-size: 8pt;
background: threedface; color: windowtext;"
onLoad="bdyLoad()" scroll=no>
<FIELDSET id=fldLink style="font-family: MS Shell Dlg; font-size: 8pt;
position: absolute; left: 0.98em; top: .8em; width: 25.76em;
height: 7.9em;">
<LEGEND id=lgdLink>
Hyperlink Information
</LEGEND>
</FIELDSET>
<DIV id=div2 style="font-family: MS Shell Dlg; font-size: 8pt; position: absolute;
left: 1.82em; top: 2.8899em; width: 2.66em; height: 1.2168em; ">
<LABEL id=lblProtocol FOR=selProtocol tabIndex=-1 helpid="35550"
helpfile=msoe.hlp>
<u>T</u>ype:
</LABEL>
</DIV>
<select id=selProtocol size=1 ACCESSKEY=t tabIndex=50
style="font-family: MS Shell Dlg; font-size: 8pt; position: absolute;
left: 5.04em; top: 2.7378em; width: 6.44em; height: 2.1294em; "
helpid="35550" helpfile=msoe.hlp>
<OPTION id=optOther value=""> (other) </OPTION>
<OPTION id=optFile value="file:"> file: </OPTION>
<OPTION id=optFtp value="ftp:"> ftp: </OPTION>
<OPTION id=optGopher value="gopher:"> gopher: </OPTION>
<OPTION id=optHttp value="http:" SELECTED> http: </OPTION>
<OPTION id=optHttps value="https:"> https: </OPTION>
<OPTION id=optMailto value="mailto:"> mailto: </OPTION>
<OPTION id=optNews value="news:"> news: </OPTION>
<OPTION id=optTelnet value="telnet:"> telnet: </OPTION>
<OPTION id=optWais value="wais:"> wais: </OPTION>
</select>
<DIV id=div3 style="font-family: MS Shell Dlg; font-size: 8pt; position: absolute;
left: 1.82em; top: 5.9319em; width: 2.52em; height: 1.2168em; ">
<LABEL id=lblURL FOR=txtURL tabIndex=-1 helpid="35550"
helpfile=msoe.hlp>
<u>U</u>RL:
</LABEL>
</DIV>
<input accesskey=u ID="txtURL" value="http://" type=text size=35
maxlength=1024 tabIndex=15 helpid="35550" helpfile=msoe.hlp
style="font-family: MS Shell Dlg; font-size: 8pt; position: absolute;
left: 5.04em; top: 5.6277em; width: 20.72em; height: 2.1294em; ">
<BUTTON id=btnOK tabIndex=35 DISABLED=1 helpid="28443" helpfile="windows.hlp"
style="font-family: MS Shell Dlg; font-size: 8pt; position: absolute;
left: 28em; top: 1.521em; width: 7em; height: 2.2em; " type=submit>
OK
</BUTTON>
<BUTTON id=btnCancel tabIndex=40 helpid="28444" helpfile="windows.hlp"
style="font-family: MS Shell Dlg; font-size: 8pt; position: absolute;
left: 28em; top: 4.1067em; width: 7em; height: 2.2em; " type=reset>
Cancel
</BUTTON>
</BODY>
</HTML>
