s  = IAS
Upgrade	       = IAS.Upgrade

; Do not copy ias.mdb 
;CopyFiles      = IAS.AddService.CopyFiles


[IAS.Services]
; 0x10 = SPSVCINST_NOCLOBBER_STARTTYPE
AddService     = IAS, 0x10, IAS.AddService

[IAS.Remove]
DelReg         = IAS.DelReg
UnregisterDlls = IAS.Unregister
ProfileItems   = IAS.Shortcut.Remove

[IAS.Remove.Services]
DelService     = IAS

;
; SNMP Extension Agent
;

[IAS.SNMPAgent]
AddAgent       = IAS.AddSNMPAgent

[IAS.Remove.SNMPAgent]
DelAgent       = IAS.Remove.DelSNMPAgent

[IAS.AddSNMPAgent]
ServiceName    = "IAS"
AgentName      = "IASAgent"
AgentPath      = "%SystemRoot%\System32\iasperf.dll"

[IAS.Remove.DelSNMPAgent]
AgentName      = "IASAgent"


;
; COM Object registration
;

[IAS.Register]
11,, iasperf.dll, 1


[IAS.Unregister]
11,, iasperf.dll, 1


;
; Administrative Tools shortcut
;

[IAS.Shortcut.Add]
Name            = %IAS_Shortcut_Display%
CmdLine         = 11,,"ias.msc /s"
IconPath        = 11,,iasmmc.dll
IconIndex       = 0
SubDir          = %Snapin-Group-Name%
Infotip         = "@%11%\iassdo.dll,-125000" 
DisplayResource = "%11%\iassdo.dll",126000


[IAS.Shortcut.Remove]
Name      = %IAS_Shortcut_Display%, 0x2
SubDir    = %Snapin-Group-Name%

[IAS.OldShortcut.Remove]
Name      = %IAS_Old_Shortcut_Display%, 0x2
SubDir    = %Snapin-Group-Name%

;
; Service Install Sections
;

[IAS.AddService]
DisplayName     = %IAS_Display%
ServiceType     = 0x20
StartType       = 2
ErrorControl    = 1
ServiceBinary   = "%%SystemRoot%%\System32\svchost.exe -k netsvcs"
Dependencies    = RPCSS
AddReg          = IAS.AddService.AddReg
Description     = %IAS_Desc%
DelReg          = IAS.AddService.DelReg 
 
[DestinationDirs] 
IAS.AddService.CopyFiles = 82, "ias"
  
[IAS.AddService.CopyFiles]
ias.mdb,wias.mdb,,16 ;Don't overwrite if already present

[IAS.AddService.CopyFiles.Security]
"D:P(A;;GRGX;;;BU)(A;;GA;;;BA)(A;;GA;;;SY)(A;;GRGX;;;WD)"

[IAS_EventLogInstallSection]
AddReg=IAS_Eventlog_AddReg
DelReg=IAS_Eventlog_DelReg
 
[IAS.AddService.AddReg]
HKR, Parameters, ServiceDll, %REG_EXPAND_SZ%, "%%SystemRoot%%\System32\ias.dll"
HKR, Parameters, Allow SNMP Set, %REG_DWORD%, 0
HKR, Parameters, ServiceDllUnloadOnStop, %REG_DWORD%, 1

HKLM, System\CurrentControlSet\Services\EventLog\System\IAS, EventMessageFile, %REG_EXPAND_SZ%, "%%SystemRoot%%\System32\iassvcs.dll;%%SystemRoot%%\System32\mprmsg.dll;%%SystemRoot%%\System32\ws03res.dll"
HKLM, System\CurrentControlSet\Services\EventLog\System\IAS, ParameterMessageFile, %REG_EXPAND_SZ%, "%%SystemRoot%%\System32\iassvcs.dll"
HKLM, System\CurrentControlSet\Services\EventLog\System\IAS, TypesSupported, %REG_DWORD%, 0x0000001f
HKLM, System\CurrentControlSet\Services\RemoteAccess\Policy, "Allow LM Authentication", 0x00010003, 0


[IAS.AddService.DelReg]
HKLM, SOFTWARE\Microsoft\INetMgr\Parameters\AddOnServices, "IAS"
HKLM, System\CurrentControlSet\Services\EventLog\Application\IAS

[IAS.DelReg]
HKLM, System\CurrentControlSet\Services\EventLog\System\IAS

[IAS.Upgrade]
; Nothing here. This just prevents the upgrade from failing on a
; "Section Not Found" error. Do not remove the upgrade section
[Strings]
Msft = "Microsoft"
IAS_Display = "Internet Authentication Service"
IAS_Desc = "Manages authentication, authorization, auditing, and accounting for virtual private network (VPN), dial-up, 802.1x wireless or Ethernet switch connection attempts sent by access servers that are compatible with the IETF RADIUS protocol. If this service is stopped, users might be unable to obtain a VPN, dial-up, wireless, or Ethernet connection to the network. If this service is disabled, any services that explicitly depend on it will fail to start."
Snapin-Group-Name = "Administrative Tools"
IAS_Shortcut_Display = "Internet Authentication Service"
IAS_Old_Shortcut_Display = "Old W2K Internet Authentication Service String"  ; this is needed by certain localized languages

REG_MULTI_SZ  = 0x10000
REG_EXPAND_SZ = 0x20000
REG_DWORD     = 0x10001
